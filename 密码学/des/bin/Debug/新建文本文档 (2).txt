3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基
F(ω)=∫_(-∞)^(
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	co
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为