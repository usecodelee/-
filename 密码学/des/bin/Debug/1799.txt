
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)



3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)




3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.

3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)





第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.












参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
第三章   小波变换预测模型的理论基础
3.1 小波分析
小波分析（Wavelet Analysis）是目前一个极为广泛的话题，作为时间―频谱分析的一种技术，解决了很多傅里叶变换不能解决的困难问题，成为继傅里叶变换以来在科学方法上的重大突破。它能够提供一个随频率改变的时-频窗口，是进行信号时频分析和处理的理想工具。它的主要特点是通过变换能够充分的突出和显示出问题某些方面的特征。因此，小波变换被应用于许多领域，并取得了成功，例如数学领域的许多学科、自动控制、天文物理、信号处理、图像处理、语音识别与合成等方面。
在1974年，由法国从事石油信号处理的工程师J.Morlet首先提出了小波变换的存在；在1986年，从数学家Y.Meyer构造出了第一个真正的小波基函数，并且与数学家S.Mallat合作一起建立了构造小波基函数的统一方法，也就是多尺度分析，之后，小波分析才开始被越来越多的人们所注视并得到迅速发展。与傅里叶变换相比，小波分析在时域和频域都具有良好的局部化特性，可以将一段较长的时间序列中提取出一个较短的周期，能够更加明显地反映出信号的非平稳性和长周期性。
本小节中，我们将对小波分析的部分基础知识、去噪原理和去噪过程进行初步的了解，为我们接下来在期货市场中使用小波进行数据分析做好一定的知识储备。
3.2 从傅里叶变换到小波变换
3.2.1 傅里叶变换
定义：若 f(t)∈L^2 (R) （L^2 (R)  为平方可积的实数空间），则
F(ω)=∫_(-∞)^(+∞)?〖f(t)e^(-jωt) dt〗                    (3.1)
f(t)=1/2π ∫_(-∞)^(+∞)?〖F(ω) e^(-jωt) dω〗                   (3.2)
其中：e^(-jωt)：一组正交基
f(t)：时域信号
F(ω)：f(t)的傅里叶变换
由此可知，傅里叶变换能够实现时域和频域之间的转换。然而，虽然傅里叶变换能够将时域信号和频域信号联系起来，但是它不能对时间和频率进行准确的定位，并没有局部化分析信号的这样一个特性。因此，人们为了克服这一缺点，进行了不断地探索，于是就产生了短时傅里叶变换和小波变换。
3.2.2 短时傅里叶变换
在1946年，Dennis Gabor提出了短时傅里叶变换，其定义为
SF(ω,τ)=∫_(-∞)^(+∞)?〖f(t)g(t-τ)e^(-jωt) 〗 dt              (3.3)
f(t)=1/2π ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?〖SF(ω,τ)g(τ-t)e^(-jωt) 〗 dωdτ          (3.4)
短时傅里叶变换的基本思想是将一段信号分成许多段较小的时间间隔，假定有一段非平稳信号在分析窗函数g(t)的一个短时间间隔内是平稳的，并移动窗函数，计算出不同时刻的频谱。可是，短时傅里叶变换使用的是一个固定的短时窗函数，因此过于单一，有缺陷。
3.2.3 小波变换
小波变换是基于傅里叶变换的，它是傅里叶变换的拓展，不仅拥有短时傅里叶变换中的局部化思想，同时还克服了短时傅里叶变换的缺陷，就目前来说，小波变换是一个较为理想的信号处理工具。
（1）定义：
设 f(t)∈L^2 (R)，其傅里叶变换为?(ω)。当?(ω)满足条件
C_?=∫_0^∞?|?(ω)|^2/ω dω<∞                    (3.5)
或其等价条件
∫_(-∞)^(+∞)?〖?(t)〗 dt=0                       (3.6)
时，函数?(t)称为一个母小波函数，其中，式(3.5)、(3.6)为小波容许条件。
将母小波?(t)进行伸缩、平移后，可得到小波序列
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.7)
其中a为尺度因子，τ为平移，a,τ∈R，a>0。?_(a,τ) (t)称为小波基函数。
（2）小波变换的原理：
假设 f(t)∈L^2 (R)，且C_?=∫_0^∞?|?(ω)|^2/ω dω<∞，则
?_(a,τ) (t)=1/√a ?(■(t-τ@a))                    (3.8)
W(a,τ)=∫_(-∞)^(+∞)?〖f(t)?_(a,τ) (t)〗 dt                 (3.9)
f(t)=1/C_?  ∫_(-∞)^(+∞)?∫_(-∞)^(+∞)?a^(-2)   W(a,τ) ?_(a,τ) (t)dadτ           (3.10)
其中，在(3.8)式中， a,τ为连续变量。所以我们也可以称(3.9)式为连续小波变换。小波变换对f(t)而言是以?_(a,τ) (t)为核函数的线性变换。
3.3 信号噪声
3.3.1 白噪声
    白噪声（white noise），如果一个序列{w_t }中的所有的观测值都是独立同分布的，并且这些观测值的均值μ和方差σ^2都是有穷的常数，则称之为白噪声或纯随机过程。
在实际的问题当中，我们一般情况下所需要考虑的噪声信号绝大部分是白噪声，而我们也将会在白噪声的基础上对信号去噪进行讨论。
3.3.2 信号去噪性能的评价标准
我们主要介绍信噪比、均方误差这两种评价标准。
信噪比（Signal-Noise Ratio）简称SNR或S/N，也称为讯噪比。常被用来判断信号去噪性能的好坏。信噪比的计量单位是dB，通常计算方法为：
SNR=10log_10 (PS/PN)                     (3.11)
PS=1/n ∑_n?f^2 (n)                       (3.12)
PN=1/n ∑_n?[f(n)-f ?(n)]^2                   (3.13)
其中，PS表示原始信号的功率；
PN表示原始信号中混杂的噪声的功率；
f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
通过对信噪比的了解及计算，我们可以得出结论，一个原始信号通过某种方法进行信号去噪后，信噪比越大，说明去噪效果越好。
均方误差（Mean Squared Error）简称MSE。可以用来对数据的变化程度进行评价。均方误差的算术平方根就是均方根误差。均方误差计算公式为：
MSE=1/N ∑_(n=1)^N?[f(n)-f ?(n)]^2                  (3.14)
其中，f(n)表示原始信号；
f ?(n)表示去噪以后的估计信号。
均方误差是一种衡量平均误差的较为简便的方法。因此可知均方误差越小，去噪效果越好。
3.4 基于小波变换的信号去噪
在实际问题中，我们实验所需要的原始数据（信号）中总是会混杂着一定的噪声，而噪声的存在会严重影响到我们对信号本质特征的探寻，并且会进一步影响到我们对信号的处理和分析。因此，我们需要对原始数据进行预处理，消除或降低其噪声。便于我们最大程度的提取原始数据中的有用信息。接下来我们将对去噪问题进行了解。
一般的常见去噪方法有基于傅里叶变换的去噪方法、基于信号的自相关去噪法、基于小波变换的信号去噪法等，由上文的讨论，我们可以知道小波变换具有时频局部分析的功能，比傅里叶变化更为实用，因此，基于小波变换的信号去噪法也就是接下来我们主要讨论的内容。
通过查阅文献，我们知道在对小波去噪的研究中，常见的小波去噪方法有屏蔽去噪法、小波变换模极大值重构法、门限法、模值积分法、小波阈值去噪法，平移不变量小波去噪法等。
3.4.1 小波去噪的基本原理:
（1）信号的小波分解： 
首先选择一个事先确定好的小波基函数和小波分解的层次N，再对含噪信号f(k)进行N层小波分解。过程如图2-1所示：
 
图3-1信号f(k)的三层小波分解过程图
图3-1中，s为含噪信号f(k)=s(k)+n(k)，cA3为低频系数，cD1、cD2、cD3为高频信号。
（2）消噪的一般过程：
通过上图的小波分解，我们可以知道，噪声部分包含在cD1、cD2、cD3（高频信号）中，然后我们对分解后的低频系数进行小波逆变换，再对分解后的高频信号选取合适的阈值进行处理后进行小波逆变换，最后对1~N层的高频信号和第N层的低频系数进行小波逆变换，这样我们就达到了消噪的目的。过程如图3-2所示：







图3-2 小波去噪的一般过程
其中，高频信号的阈值处理，是需要首先选择一个合适的阈值量化准则，然后才开始对每一个分解层次中的高频信号进行阈值量化处理；而重构信号则是根据阈值处理后的1~N层的高频信号和第N层的低频系数进行小波逆变换，最后才去对消噪后的信号进行重构。这就是一段信号小波去噪的一般过程。
3.4.2 小波基的选取
目前有几十种小波基函数，它们适用于不同的应用场合，不同的小波基函数有不同的去噪效果。因此我们选取一个合适的小波基函数是十分重要的，接下来将会介绍一些小波基函数的特性，我们可以通过这些特性来选取合适的小波基函数。
（1）正则性：正则性是小波基函数的光滑性的度量，正则性越好，函数收敛越快，函数图像越平滑。
（2）紧支撑性：支撑的宽度与计算时间成正比，支撑宽度越小，则计算时间就越短，小波的局部分辨能力就越好，便于除噪。反之，支撑的宽度越长，计算时间就越长，这样的话将会使小波的局部分辨能力受到一定的影响。
（3）消失距：若∫_(-∞)^(+∞)?〖?(t) t^m dt〗=0，（m=0,1,λ,M-1），则称小波具有M阶消失距。消失距越高，函数的光滑性就越好，频域的局部化能力就越强。消失距反映了小波基函数对信号的奇异性检测能力的强弱。
根据这些特征，综合分析，这些小波基函数中，选择其中具有较好的正则性、紧支撑性、消失距这三个性质的小波函数有dbN（Daubechies小波）、symN（Symlets小波）、coifN（Coiflet小波）等。在本文中，我们将使用dbN小波进行小波分析。
Haar											
db	db1	db2	db3	db4	db5	db6	db7	db8	db9	db10	
sym	sym2	sym3	sym4	sym5	sym6	sym7	sym8				
coif	coif1	coif2	coif3	coif4	coif5	coif6	coif7	coif8	coif9	coif10	
bior	bior1.1	bior1.3	bior1.5	bior2.2	bior2.4	bior2.6	bior2.8	bior3.5	bior3.7	bior3.9	bior4.4
表3-1 常见的几种小波函数
3.4.3 小波分解层数
在小波分解过程中，我们所选取的尺度越大，则噪声和信号表现的不同特征就越明显，越有利于信噪分离，可是当我们分解的次数过多时，对于重构信号来说，就会使得重构误差越大，也即失真越大。所以，我们必须选择一个合适的尺度参数，兼顾两者。
3.4.4 dbN小波
dbN小波是由著名的数学家Ingrid Daubechies提出的。其中N表示阶数。dbN小波?(t)的长度有限，N的值越大，?(t)的长度就越长。dbN小波并没有一个明确的解析表达式，在频域?(ω)在ω=0处有N阶零点，小波函数?(t)可以由尺度函数Φ(t)求出来，尺度函数Φ(t)为低通函数，长度有限，支撑域为t=0~(2N-1)。
3.4.5 基于阈值的小波去噪方法
在小波去噪的过程中，阈值的选取是一个很重要的问题，这关系着去噪效果的优劣。如果阈值选取过小，则将会有一部分噪声不能被去除，使得信号去噪的效果差；如果阈值选取过大，则将会有一部分有用的信号丢失，也会影响到信号去噪的效果。因此，为了使我们的小波去噪更为有效，我们必须选取合适的阈值，这一点是十分重要的。
（1）硬阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，则不变，用公式可表达为：
w_λ={■(w      |w|≥λ@ @0       |w|<λ)┤                       (3.15)
（2）软阈值去噪法
当小波系数的绝对值小于一个事先给定的阈值时，令其为零；大于阈值时，令这些小波系数都减去这个阈值，用公式可表达为：
w_λ={■([sgn(w)]( |w|-λ)      |w|≥λ@ @0                                       |w|<λ)┤                (3.16)
（3）两者之间的比较及优缺点
硬阈值在均方误差的意义上是优于软阈值法的，软阈值法估计得到的小波系数的整体连续性好；不足的是，硬阈值不具有同原始信号一样的光滑性，在软阈值法中，若|w|≥λ，w_λ与w之间总是存在着恒定的方差，会直接影响到重构信号与原始信号的逼近程度。
3.4.6 小波去噪的阈值选择标准
（1）无偏似然估计阈值：（rigrsure）
无偏似然估计原则是一种基于无偏似然估计原理的自适应阈值选择，对一个已经给定了的阈值t，进行似然估计，然后将其似然t最小化，就可以得到所选取的阈值了。它的计算公式为λ_k=√(f(k_min))，其中k_min为最小风险点所对应的值。
（2）固定阈值：（sqtwolog）
固定阈值的计算公式为λ=√(2log(N))。
（3）启发式阈值：（heursure）
启发式阈值是无偏似然估计阈值和固定阈值的折中。当信噪比比较小的时候，如果我们按照无偏似然估计阈值原则来进行处理的信号噪声较大时，我们就可以使用启发式阈值。
（4）极大极小阈值：（minimaxi）
极大极小阈值采用极大极小原理选择阈值，这时会产生一个最小均方误差的极值。它的表达式为
λ={■(0.3936+0.1829(lnN/ln2)         N>32@■( @0                                                  N≤32))┤             (3.17)

















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.














参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.















参考文献
[1]吴勇. 基于小波的信号去噪方法研究[D]. 武汉理工大学,2007.
[2]吴喜之,刘苗. 应用时间序列分析[M]. 北京：机械工业出版社,2014.7.
[3][美]Ingrid Daubechies 著. 李建平,杨万年 译. 小波十讲[M]. 北京：国防工业出版社,2004.5.
[4]兰秋军,马超群,文凤华. 金融时间序列去噪的小波变换方法[J]. 科技管理研究,2004,(06):117-120.
